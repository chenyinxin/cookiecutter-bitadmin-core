<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <script type="text/javascript" src="../internal.js"></script>
    <style type="text/css">
        .wrapper{width: 600px;padding: 10px;height: 352px;overflow: hidden;position: relative;border-bottom: 1px solid #d7d7d7}
        .localPath input{float: left;width: 350px;line-height: 20px;height: 20px;}
        #clipboard{float:left;width: 70px;height: 30px; }
        .description{ color: #0066cc; margin-top: 2px; width: 450px; height: 45px;float: left;line-height: 22px}
        #upload{width: 100px;height: 30px;float: right; margin:10px 2px 0 0;cursor: pointer;}
        #msg{ width: 140px; height: 30px; line-height:25px;float: left;color: red}
    </style>
</head>
<body>
    <div class="wrapper">
        <div class="localPath">
            <input id="localPath" type="text" readonly />
            <div id="clipboard"></div>
            <div id="msg"></div>
        </div>
        <div id="flashContainer"></div>
        <div>
            <div id="upload" style="display: none" ><img id="uploadBtn"></div>
            <div class="description">
                <span style="color: red"><var id="lang_resave"></var>: </span><var id="lang_step"></var>
            </div>
          </div>
    </div>
    <script type="text/javascript" src="tangram.js"></script>
    <script type="text/javascript" src="wordimage.js"></script>
    <script type="text/javascript">
        editor.setOpt({
            wordImageFieldName:"upfile",
            compressSide:0,
            maxImageSideLength:900
        });

            //鍏ㄥ眬鍙橀噺
        var imageUrls = [],          //鐢ㄤ簬淇濆瓨浠庢湇鍔″櫒杩斿洖鐨勫浘鐗囦俊鎭暟缁?            selectedImageCount = 0,  //褰撳墠宸查€夋嫨鐨勪絾鏈笂浼犵殑鍥剧墖鏁伴噺
            optImageUrl = editor.getActionUrl(editor.getOpt('imageActionName')),
            optImageFieldName = editor.getOpt('imageFieldName'),
            optImageCompressBorder = editor.getOpt('imageCompressEnable') ? editor.getOpt('imageCompressBorder'):null,
            maxSize = editor.getOpt('imageMaxSize') / 1024,
            extension = editor.getOpt('imageAllowFiles').join(';').replace(/\./g, '*.');

        /* 娣诲姞棰濆鐨凣ET鍙傛暟 */
        var params = utils.serializeParam(editor.queryCommandValue('serverparam')) || '',
            urlWidthParams = optImageUrl + (optImageUrl.indexOf('?') == -1 ? '?':'&') + params;

        utils.domReady(function(){
            //鍒涘缓Flash鐩稿叧鐨勫弬鏁伴泦鍚?            var flashOptions = {
                container:"flashContainer",                                                    //flash瀹瑰櫒id
                url:urlWidthParams,                                           // 涓婁紶澶勭悊椤甸潰鐨剈rl鍦板潃
                ext:editor.queryCommandValue('serverParam') || {},                                 //鍙悜鏈嶅姟鍣ㄦ彁浜ょ殑鑷畾涔夊弬鏁板垪琛?                fileType:'{"description":"'+lang.fileType+'", "extension":"' + extension + '"}',     //涓婁紶鏂囦欢鏍煎紡闄愬埗
                flashUrl:'imageUploader.swf',                                                  //涓婁紶鐢ㄧ殑flash缁勪欢鍦板潃
                width:600,          //flash鐨勫搴?                height:272,         //flash鐨勯珮搴?                gridWidth:120,     // 姣忎竴涓瑙堝浘鐗囨墍鍗犵殑瀹藉害
                gridHeight:120,    // 姣忎竴涓瑙堝浘鐗囨墍鍗犵殑楂樺害
                picWidth:100,      // 鍗曞紶棰勮鍥剧墖鐨勫搴?                picHeight:100,     // 鍗曞紶棰勮鍥剧墖鐨勯珮搴?                uploadDataFieldName: optImageFieldName,    // POST璇锋眰涓浘鐗囨暟鎹殑key
                picDescFieldName:'pictitle',      // POST璇锋眰涓浘鐗囨弿杩扮殑key
                maxSize: maxSize,                         // 鏂囦欢鐨勬渶澶т綋绉?鍗曚綅M
                compressSize:1,                   // 涓婁紶鍓嶅鏋滃浘鐗囦綋绉秴杩囪鍊硷紝浼氬厛鍘嬬缉,鍗曚綅M
                maxNum:32,                         // 鍗曟鏈€澶у彲涓婁紶澶氬皯涓枃浠?                compressSide: 0,                 //绛夋瘮鍘嬬缉鐨勫熀鍑嗭紝0涓烘寜鐓ф渶闀胯竟锛?涓烘寜鐓у搴︼紝2涓烘寜鐓ч珮搴?                compressLength: optImageCompressBorder        //鑳芥帴鍙楃殑鏈€澶ц竟闀匡紝瓒呰繃璇ュ€糉lash浼氳嚜鍔ㄧ瓑姣斿帇缂?            };
            //鍥炶皟鍑芥暟闆嗗悎锛屾敮鎸佷紶閫掑嚱鏁板悕鐨勫瓧绗︿覆銆佸嚱鏁板彞鏌勪互鍙婂嚱鏁版湰韬笁绉嶇被鍨?            var callbacks={
                selectFileCallback: function(selectFiles){                // 閫夋嫨鏂囦欢鐨勫洖璋?                    selectedImageCount += selectFiles.length;
                    if(selectedImageCount) baidu.g("upload").style.display = "";
                    dialog.buttons[0].setDisabled(true); //鍒濆鍖栨椂缃伆纭畾鎸夐挳
                },
                deleteFileCallback: function(delFiles){                 // 鍒犻櫎鏂囦欢鐨勫洖璋?                    selectedImageCount -= delFiles.length;
                    if (!selectedImageCount) {
                        baidu.g("upload").style.display = "none";
                        dialog.buttons[0].setDisabled(false);         //娌℃湁閫夋嫨鍥剧墖鏃堕噸鏂扮偣浜寜閽?                    }
                },
                uploadCompleteCallback: function(data){               // 鍗曚釜鏂囦欢涓婁紶瀹屾垚鐨勫洖璋?                    try{var info = eval("(" + data.info + ")");
                    info && imageUrls.push(info);
                    selectedImageCount--;
                    }catch(e){}
                },
                uploadErrorCallback: function (data){         // 鍗曚釜鏂囦欢涓婁紶澶辫触鐨勫洖璋?
                    console && console.log(data);
                },
                allCompleteCallback: function(){              // 鍏ㄩ儴涓婁紶瀹屾垚鏃剁殑鍥炶皟
                    dialog.buttons[0].setDisabled(false);    //涓婁紶瀹屾瘯鍚庣偣浜寜閽?                }
                //exceedFileCallback: 'exceedFileCallback',   // 鏂囦欢瓒呭嚭闄愬埗鐨勬渶澶т綋绉椂鐨勫洖璋?                //startUploadCallback: startUploadCallback    // 寮€濮嬩笂浼犳煇涓枃浠舵椂鐨勫洖璋?            };
            wordImage.init(flashOptions,callbacks);
        });

    </script>

</body>
</html>