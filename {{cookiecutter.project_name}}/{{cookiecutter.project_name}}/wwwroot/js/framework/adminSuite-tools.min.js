$.fn.bitSelect=function(){var n=$(this),i=n.attr("data-url"),t={text:"text",value:"value"},r;return $.extend(t,{text:n.attr("data-text"),value:n.attr("data-value")}),i!=null&&i!=""&&i!=undefined&&$.getJSON(i,{type:n.attr("data-type")},function(t){r(n,t.data,!0)}),r=function(i,r,u){var e,f;$(i).empty();$(i).data("bind",r);u&&$(i).append($("<option value=''>===请选择===<\/option>"));e=n.attr("data-actualval");for(f in r)$(i).append($("<option value='"+r[f][t.value]+"' "+(e+""==r[f][t.value]?"selected":"")+">"+r[f][t.text]+"<\/option>"))},t.change=function(t,i){$.isFunction(t)?n.change(function(){var i=$(n).data("bind")[n.get(0).selectedIndex-1];t(i)}):n.change(function(){if($.isFunction(t[i])){var r=$(n).data("bind")[n.get(0).selectedIndex-1];t[i](r)}})},t};$.fn.bitRadio=function(){var n=$(this),i=n.attr("data-url"),t={text:"text",value:"value",inline:"true"};return $.extend(t,{text:n.attr("data-text"),value:n.attr("data-value"),inline:n.attr("data-inline")}),t.parent=n.parent(),i!=null&&i!=""&&i!=undefined&&$.getJSON(i,{type:n.attr("data-type")},function(i){var c=n.find('input[type="radio"]'),e=$(n[0].outerHTML).html(""),s,h,o,f,r,u;t.inline!="false"&&e.addClass("radio-inline");s=e.clone().removeAttr("data-control data-type data-text data-value data-inline data-url data-change");h=n.attr("data-actualval");t.parent.html("");o=0;for(f in i.data)$.isFunction(i.data[f])||(r=null,r=o==0?e.clone():s.clone(),u=c.clone(),u.data("bind",i.data[f]),u.val(i.data[f][t.value]),h==u.val()&&u.prop("checked","checked"),r.append(u),r.append(i.data[f][t.text]),t.inline=="false"?t.parent.append($('<div class="checkbox"><\/div>').append(r)):t.parent.append(r),o++)}),t.change=function(t,i){var r;$.isFunction(t)?(r=n.parent().find('input[type="radio"]'),r.change(function(){var i=$(n);t(i)})):(r=n.parent().find('input[type="radio"]'),r.change(function(){if($.isFunction(t[i])){var r=$(n);t[i](r)}}))},t};$.fn.bitCheckbox=function(n){var i=$(this),r=i.attr("data-url"),t={text:"text",value:"value",inline:"true"};return $.extend(t,{text:i.attr("data-text"),value:i.attr("data-value"),inline:i.attr("data-inline")}),t.parent=i.parent(),r!=null&&r!=""&&r!=undefined&&$.getJSON(r,{type:i.attr("data-type")},function(r){var l=i.find('input[type="checkbox"]'),s=$(i[0].outerHTML).html(""),c,o,h,e,f,u;t.inline!="false"&&s.addClass("checkbox-inline");c=s.clone().removeAttr("data-control data-type data-text data-value data-inline data-url data-change");o=i.attr("data-actualval");t.parent.html("");h=0;for(e in r.data)$.isFunction(r.data[e])||(f=null,f=h==0?s.clone():c.clone(),u=l.clone(),u.data("bind",r.data[e]),u.val(r.data[e][t.value]),o!=""&&o!=null&&(","+o+",").indexOf(","+u.val())>0&&u.prop("checked","checked"),$.isFunction(n)&&u.click(function(){n($(this),$(this).data("bind"))}),f.append(u),f.append(r.data[e][t.text]),t.inline=="false"?t.parent.append($('<div class="checkbox"><\/div>').append(f)):t.parent.append(f),h++)}),t};$.fn.bitAutoComplete=function(){var n=$(this),i={text:"text"},t;return $.extend(i,{text:n.attr("data-text")}),t=n.attr("data-url"),t!=null&&t!=""&&t!=undefined&&$.getJSON(t,{type:n.attr("data-type")},function(t){var r=[];for(var u in t.data)$.isFunction(t.data[u])||r.push(t.data[u][i.text]);n.autocomplete({source:r,change:function(t,i){$(n).data("bind",i)}})}),i.change=function(t,i){$.isFunction(t)?n.change(function(){var i=$(n)[0].value;t(i)}):n.change(function(){if($.isFunction(t[i])){var r=$(n)[0].value;t[i](r)}})},i};$.fn.bitAutoComSelect=function(){var n=$(this),r,t={text:"text",value:"value",target:""},i;return $.extend(t,{text:n.attr("data-text"),value:n.attr("data-value"),target:n.attr("data-target")}),i=n.attr("data-url"),i!=null&&i!=""&&i!=undefined&&$.getJSON(i,{type:n.attr("data-type")},function(i){var f=[];for(var u in i.data)$.isFunction(i.data[u])||f.push({label:i.data[u][t.text],value:i.data[u][t.text],dataVal:i.data[u][t.value]});n.autocomplete({delay:0,minLength:0,source:f,select:function(n,t){r=t.item},change:function(i,u){if(u.item==null){n.next("[name="+t.target+"]").val("");r="";return}n.next("[name="+t.target+"]").val(u.item.dataVal)}})}),t.change=function(t,i){$.isFunction(t)?n.change(function(){var n=r;t(n)}):n.change(function(){if($.isFunction(t[i])){var n=r;t[i](n)}})},t};$.fn.bitTree=function(n){var i=$(this),t={url:null,checkbox:!1,text:"text",nodes:"children",expandIcon:"glyphicon glyphicon-chevron-right",collapseIcon:"glyphicon glyphicon-chevron-down",onNodeSelected:function(){},onNodeUnselected:function(){},bind:null,treeview:null,loadCallback:function(){}},r;return $.extend(t,{url:i.attr("data-url"),checkbox:i.attr("data-checkbox"),text:i.attr("data-text"),nodes:i.attr("data-nodes")}),$.extend(t,n),r=function(n){for(var i in n)n[i].text=n[i][t.text],n[i].nodes=n[i][t.nodes],r(n[i].nodes)},t.load=function(n){return $.isFunction(n)&&(t.loadCallback=n),n==undefined&&$.ajax({url:t.url,type:"post",cache:!1,async:!0,data:{},success:function(n){r(n.data);t.treeview=i.treeview({expandIcon:t.expandIcon,collapseIcon:t.collapseIcon,data:n.data,showCheckbox:t.checkbox,onNodeSelected:t.onNodeSelected,onNodeUnselected:t.onNodeUnselected});$.isFunction(t.loadCallback)&&t.loadCallback(n)}}),t},t.select=function(n){return $.isFunction(n)&&(t.onNodeSelected=n),t},t.unselect=function(n){return $.isFunction(n)&&(t.onNodeUnselected=n),t},t};$.fn.picker=function(n){var i=$(this),t=i.find("[type=text]"),r=i.find("[type=hidden]"),u=t.attr("name"),y=r.attr("name"),c=i.attr("data-url"),l=i.attr("data-param"),f=i.attr("data-icon"),p=i.attr("data-remove"),o,s,h;(n==undefined||n==null)&&(n="");var a={text:n+" [name="+u+"]",value:n+" [name="+y+"]"},e=!1,v=function(){var i,t,r;if(!e){if(e=!0,l!=undefined){i={};t=l.split(",");for(r in t)if(typeof t[r]=="string"){var f=t[r].split(":"),o=f[0],n=f[1];i[o]=n!=null&&n.indexOf("&")>=0?$(wrapper+" [name="+n.substr(1)+"]").val():n!=null&&n.indexOf("#")>=0?$("#"+n.substr(1)).val():n}$.extend(a,i)}pickType=c.replace(/\./g,"p").replace(/\//g,"p");$("[data-picker-type="+pickType+"]").remove();$("body").append('<div id="'+u+'" data-picker-type='+pickType+"><\/div>");$("#"+u).attr("data-param",JSON.stringify(a));$("#"+u).load(c);e=!1}};return t.unbind("click"),t.click(v),(f==undefined||f=="")&&(f="glyphicon-list-alt"),o=$('<span class="input-group-addon"><i class="glyphicon '+f+'"><\/i><\/span>'),o.click(v),$(this).append(o),p!="false"&&(s=$('<span class="input-group-addon"><i class="glyphicon glyphicon-remove"><\/i><\/span>'),$(this).append(s),s.click(function(){t.val("");r.val("")})),i.addClass("input-group"),t.parent().children("span").css("cursor","pointer"),t.attr("readonly","readonly"),t.css("background-color","white"),t.css("border-right","0px"),h={},h.change=function(n,i){$.isFunction(n)?t.change(function(){n(r.val(),t.val())}):t.change(function(){$.isFunction(n[i])&&n[i](r.val(),t.val())})},h};$.fn.datePicker=function(){var n=$(this),i=n.find("input"),t={format:"YYYY-MM-DD hh:mm:ss",minDate:"1900-01-01 00:00:00",maxDate:"2099-12-31 23:59:59",festival:!1,zIndex:2099,isShowCalendar:!0,isShowRemove:!0,choosefun:function(){}},f={format:n.attr("data-format").replace("yyyy","YYYY").replace("dd","DD").replace("HH","hh"),minDate:n.attr("data-min"),maxDate:n.attr("data-max")},r,u;return $.extend(t,f),n.find(".input-group-addon").remove(),n.removeClass("input-group"),(t.isShowCalendar=!0)&&(r=$('<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"><\/i><\/span>'),r.click(function(){i.click()}),n.append(r)),t.isShowRemove==!0&&(u=$('<span class="input-group-addon"><i class="glyphicon glyphicon-remove"><\/i><\/span>'),u.click(function(){i.val("")}),n.append(u)),n.addClass("input-group"),n.children("span").css("cursor","pointer"),i.attr("readonly","readonly"),i.css("background-color","white"),i.css("border-right","0px"),i.jeDate(t),t.change=function(n,i){t.choosefun=$.isFunction(n)?n:function(){$.isFunction(n[i])&&(t.choosefun=n[i])}},t};$.fn.linkageSelect=function(){var t=$(this),i=t.attr("data-url"),u=t.attr("data-ajax"),r=t.find("select:first"),n={text:"text",value:"value"},f;return n.wrapper=t,f={text:t.attr("data-text"),value:t.attr("data-value")},$.extend(n,f),i!=null&&i!=""&&i!=undefined&&$.getJSON(i,{type:r.attr("data-type"),parent:""},function(t){n.bind(r,t.data,!0);n.bindChange(r)}),n.clearNext=function(t){var i=$(t).next("select");i.length!=0&&(i.empty(),i.val(""),n.clearNext(i))},n.bindChange=function(t){var r=$(t).next("select");r.length!=0&&($(t).change(function(){var f=$(t).val(),e;n.clearNext(t);u=="true"&&f!=""?(e=r.attr("data-type"),$.getJSON(i,{type:e,parent:f},function(t){n.bind(r,t.data,!0)})):u=="true"?n.bind(r,{},!1):$(t).get(0).selectedIndex>0&&n.bind(r,$(t).data("bind")[$(t).get(0).selectedIndex-1].children,!0)}),n.bindChange(r))},n.bind=function(t,i,r){var u,f,e,o;$(t).empty();$(t).data("bind",i);u=$(t).attr("data-actualval");r&&$(t).append($("<option value=''>===请选择===<\/option>"));for(f in i)e="",u==i[f][n.value]&&(e="selected"),o=$("<option value='"+i[f][n.value]+"' "+e+" >"+i[f][n.text]+"<\/option>"),$(t).append(o);u!=null&&u!=""&&($(t).attr("data-actualval",""),$(t).change())},n.change=function(i,r){return $.isFunction(i)?t.find("select:last").change(function(){var n=$(this).data("bind")[$(this).get(0).selectedIndex-1];i(n)}):t.find("select:last").change(function(){if($.isFunction(i[r])){var n=$(this).data("bind")[$(this).get(0).selectedIndex-1];i[r](n)}}),n},n};$.fn.treeTable=function(n){function o(n){$.each(n,function(n,r){var e="",f;r[t.parentKey]!=""&&r[t.parentKey]!=null&&(e="  treegrid-parent-"+r[t.parentKey]);f=$("<tr class='treegrid-"+r[t.key]+e+"'><\/tr>");$.each(i.children("thead").children("tr").children("th"),function(n){var e=$(this).attr("style"),c,i,s,h,o;e=e!=undefined&&e!=""&&e!="undefined"?"style='"+e+"'":"";$(this).find('input[type="checkbox"]').length>0&&n==0?(u=1,c=$('<input type="checkbox" value="'+r[t.key]+"\" class='SelectRow' />"),o=$('<td  style="text-align:center"><\/td>'),o.append(c),f.append(o)):(i=$(this).attr("data-format"),s=r[$(this).attr("data-field")],i!="undefined"&&i!=undefined&&(i.indexOf("time|")==0||i=="time"?(h=i.split("|"),s=(h.length=2)?time.format(s,h[1]):time.format(s,"yyyy-MM-dd hh:mm:ss")):s=eval("_option."+i+"(d)")),o=$("<td "+e+"><\/td>"),o.append(s),f.append(o))});i.find("tbody").append(f);r[t.childrenKey]!=null&&r[t.childrenKey]!=""&&o(r[t.childrenKey])})}var f=$(this),e=f.find(".querySuite-button"),r=f.find(".querySuite-table"),i=r.find("table"),u,t;return e.addClass("container-fluid"),i.addClass("table table-bordered table-hover"),u=0,t={key:"id",parentKey:"parentId",childrenKey:"children",treeGrid:null,query:null,"delete":null},t=$.extend(t,n,{queryUrl:r.attr("data-query-url"),deleteUrl:r.attr("data-delete-url"),key:r.attr("data-key"),parentKey:r.attr("data-parent"),childrenKey:r.attr("data-children")}),t.delete=function(){var n=i.find(".SelectRow:checked"),r=[];if(n.length>0&&$.each(n,function(n,t){var i=$(t).attr("value");r.push(i)}),n.length==0){alert("请选择要删除的项");return}confirm("您确定要删除所选内容吗？")&&$.ajax({type:"get",url:t.deleteUrl,datatype:"json",async:!1,data:{IDs:r.toString()},success:function(n){n.code==0?(alert("删除成功！"),t.query()):alert(n.msg)}})},t.query=function(){$.ajax({type:"get",url:t.queryUrl,datatype:"json",async:!1,success:function(n){n&&n.code==0?(i.children("tbody").remove(),i.append("<tbody><\/tbody>"),o(n.data),t.treeGrid=i.treegrid({treeColumn:u,initialState:t.initialState})):alert(n.msg)}})},i.children("thead").find("th:eq(0)").find('input[type="checkbox"]').bind("change",function(){var n=$(this).prop("checked");n==!1?i.find(".SelectRow").prop("checked",!1):i.find(".SelectRow").prop("checked",!0)}),t.query(),e.find("[action='delete']").click(function(){t.delete()}),t};$.extend($.validator.prototype,{defaultMessage:function(n,t){return this.findDefined(this.customMessage(n.name,t.method),this.customDataMessage(n,t.method),undefined,$.validator.messages[t.method],"<strong>警告: 没有为("+n.name+")定义消息<\/strong>")},showLabel:function(n,t){var r,o,f,i=this.errorsFor(n),e=this.idOrName(n),u=$(n).attr("aria-describedby"),s;i.length?(i.removeClass(this.settings.validClass).addClass(this.settings.errorClass),i.html("*")):(i=$("<"+this.settings.errorElement+">").attr("id",e+"-error").addClass(this.settings.errorClass).html("*"),r=i,this.settings.wrapper&&(r=i.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(r):this.settings.errorPlacement?this.settings.errorPlacement(r,$(n)):r.insertAfter(n),i.is("label")?i.attr("for",e):i.parents("label[for='"+e+"']").length===0&&(f=i.attr("id").replace(/(:|\.|\[|\]|\$)/g,"\\$1"),u?u.match(new RegExp("\\b"+f+"\\b"))||(u+=" "+f):u=f,$(n).attr("aria-describedby",u),o=this.groups[n.name],o&&$.each(this.groups,function(n,t){t===o&&$("[name='"+n+"']",this.currentForm).attr("aria-describedby",i.attr("id"))})));!t&&this.settings.success?(i.text(""),typeof this.settings.success=="string"?i.addClass(this.settings.success):this.settings.success(i,n)):(s=t=="*",s?(t="必填项",this.toShow=this.toShow.add(i)):i.hide(),$(this.currentForm).find("[name='"+e+"']").attr("title",t));this.toShow=this.toShow.add(i)}});$.extend(jQuery.validator.messages,{required:"*",remote:"请指定一个不重复的值",email:"请输入正确格式的电子邮件",url:"请输入合法的网址",date:"请输入合法的日期",dateISO:"请输入合法的日期 (ISO).",number:"请输入合法的数字",digits:"只能输入整数",creditcard:"请输入合法的信用卡号",equalTo:"请再次输入相同的值",accept:"请输入拥有合法后缀名的字符串",maxlength:jQuery.validator.format("允许的最大长度为 {0} 个字符"),minlength:jQuery.validator.format("允许的最小长度为 {0} 个字符"),rangelength:jQuery.validator.format("允许的长度为{0}和{1}之间"),range:jQuery.validator.format("请输入介于 {0} 和 {1} 之间的值"),max:jQuery.validator.format("请输入一个最大为 {0} 的值"),min:jQuery.validator.format("请输入一个最小为 {0} 的值")});$.validator.addMethod("idcard",function(n,t){var r=n.length,i;return r==15?i=new RegExp(/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/):r==18&&(i=new RegExp(/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/)),this.optional(t)||i.test(n)},"请输入正确的身份证号码。");$.validator.addMethod("phone",function(n,t){return this.optional(t)||/^1\d{10}$/.test(n)},"请输入正确的手机号码");$.validator.addMethod("telephone",function(n,t){return this.optional(t)||/^\d{3}-\d{7,8}|\d{4}-\{7,8}$/.test(n)},"请输入正确的电话号码");$.validator.addMethod("starttime",function(n,t){var i=$("#"+$(t).attr("data-starttime")).val(),r=n,u=new RegExp("-","g");return i=i.replace(u,"/"),r=r.replace(u,"/"),i=new Date(parseInt(Date.parse(i),10)),r=new Date(parseInt(Date.parse(r),10)),i>r?!1:!0},"结束日期必须大于开始日期");